#include "button.h"
#include "main.h"
#include "led.h"

extern LED ledR;
extern LED ledB;
uint16_t TickOnB1 = 0;
uint16_t TickOffB1 = 0;
uint16_t DelayTick = 0;
uint16_t DelayTickBetPrees = 0;

void buttonInit(BUTTON* button , GPIO_TypeDef* GPIOx , uint16_t GPIO_Pin)
{
	button->state = BUTTON_STATE_NONE;
	button->timetick = 0 ;
	button->GPIOx = GPIOx;
	button->GPIO_Pin = GPIO_Pin;
}


void buttonInterrupt(BUTTON* button)
{
	if(HAL_GPIO_ReadPin(B1_GPIO_Port, B1_Pin) == 1)
	{
		TickOffB1=HAL_GetTick();
	}

	else if(HAL_GPIO_ReadPin(B1_GPIO_Port, B1_Pin) == 0)
	{
		TickOnB1=HAL_GetTick();
	}

	DelayTick=TickOffB1-TickOnB1;
	DelayTickBetPrees = TickOnB1-TickOffB1;

	if(DelayTick > 500)
	{
	   button->state = BUTTON_LONG_PRESS;
	}
	else
	{
        if(DelayTickBetPrees > 200)
		{
			   button->state = BUTTON_STATE_PRESS;
		}
		else
		{
	     button->state = BUTTON_DOBULE_PRESS;
	    }
	}

}


